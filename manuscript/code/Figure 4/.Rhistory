source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
getwd()
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
## Rat ####
rat_healthy_plot <-
ggplot()+
geom_line(data = mouse_san,
aes(x = mouse_san[,1],
y = mouse_san[,2]))+
theme_clean()+
labs(x = "Time (s)",
y = "Voltage (mV)")+
coord_cartesian(x = c(0, 0.5),
y = c(-80, 60))+
q
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
## Rat ####
rat_healthy_plot <-
ggplot()+
geom_line(data = rat_healthy,
aes(x = rat_healthy[,1],
y = rat_healthy[,2]))+
theme_clean()+
labs(x = "Time (s)",
y = "Voltage (mV)")+
coord_cartesian(x = c(0, 1),
y = c(-80, 60))+
q
rat_healthy_plot
## Rat ####
rat_healthy_plot <-
ggplot()+
geom_line(data = rat_healthy,
aes(x = rat_healthy[,1],
y = rat_healthy[,2]))+
theme_clean()+
labs(x = "Time (s)",
y = "Voltage (mV)")+
coord_cartesian(x = c(0, 0.25),
y = c(-80, 60))+
q
rat_healthy_plot
## GP ####
gp_ventricular_plot <-
ggplot()+
geom_line(data = gp_ventricular,
aes(x = gp_ventricular[,1],
y = gp_ventricular[,2]))+
theme_clean()+
labs(x = "Time (s)",
y = "Voltage (mV)")+
coord_cartesian(x = c(0, 0.25),
y = c(-80, 60))+
q
gp_ventricular_plot <-
ggplot()+
geom_line(data = gp_ventricular,
aes(x = gp_ventricular[,1],
y = gp_ventricular[,2]))+
theme_clean()+
labs(x = "Time (s)",
y = "Voltage (mV)")+
coord_cartesian(x = c(0, 0.5),
y = c(-80, 60))+
q
gp_ventricular_plot
## hiPSC-CMs ####
hiPSC_ventricular_mature <-
ggplot()+
geom_line(data = hiPSC_ventricular_mature,
aes(x = hiPSC_ventricular_mature[,1],
y = hiPSC_ventricular_mature[,2]))+
theme_clean()+
labs(x = "Time (s)",
y = "Voltage (mV)")+
coord_cartesian(x = c(0, 0.5),
y = c(-80, 60))+
q
hiPSC_ventricular_mature
## hiPSC-CMs ####
hiPSC_ventricular_mature_plot <-
ggplot()+
geom_line(data = hiPSC_ventricular_mature,
aes(x = hiPSC_ventricular_mature[,1],
y = hiPSC_ventricular_mature[,2]))+
theme_clean()+
labs(x = "Time (s)",
y = "Voltage (mV)")+
coord_cartesian(x = c(0, 0.5),
y = c(-80, 60))+
q
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
# Transforming the traces and adding the x axis ########
## Mouse SAN ####
mouse_san <- data.frame(seq.int(0,
49999*mouse_san_abf$samplingIntervalInSec,
mouse_san_abf$samplingIntervalInSec),
mouse_san_abf$data[[1]][20000:70000])
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
# Combine
combined <-
plot_grid(mouse_san_plot,
rat_healthy_plot,
gp_ventricular_plot,
hiPSC_ventricular_mature_plot,
ncol = 4,
labels = AUTO)
combined
# Combine
combined <-
plot_grid(mouse_san_plot,
rat_healthy_plot,
gp_ventricular_plot,
hiPSC_ventricular_mature_plot,
ncol = 4,
labels = "AUTO")
# Combine
combined <-
plot_grid(mouse_san_plot,
rat_healthy_plot,
gp_ventricular_plot,
hiPSC_ventricular_mature_plot,
ncol = 4,
labels = "AUTO")
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 1/Figure 1.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
getwd()
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
rat_ventricular_plot
# Combining with mean parameters
source("Parameter_Comparison.R")
# Combining with mean parameters
source("Figure 4 - Parameter_Comparison.R")
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Parameter_Comparison.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Parameter_Comparison.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
df %>%
select(-c(Operator.x, Operator.y)) %>%
gather(Operator, "Value", -c(`File Name`, Folder, Conditions, Parameter)) %>%
#filter(Parameter == "STV") %>%
ggplot(aes(x = `File Name`,
y = `Value`,
colour = `Operator`,
group = `Operator`))+
geom_point(alpha = 0.8)+
theme_clean()+
theme(#axis.text.x = element_text(angle = 90, hjust = 1),
axis.text.x=element_blank(),
legend.title = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = "bold"),
axis.line=element_line(),
axis.title.x = element_blank())+
scale_colour_manual(values = c("#8C5471", "black"))+
facet_wrap(~`Parameter`, ncol = 1, scales = "free")+
xlab("File")+
ggtitle("Manual vs Automated Parameter Analysis")
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Parameter_Comparison.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
rat_freq_means_plot <-
df %>%
filter(variable != "SD1_SD2 Ratio",
variable != "Peak (mV)",
variable != "SD2",
`Condition 4` == "1Hz") %>%
ggplot(aes(x = `Condition 2`,
y = value,
fill = `Condition 2`))+
stat_summary(fun = "mean", geom = "bar", colour = "black")+
stat_summary(fun.data = "mean_se", geom = "errorbar", width = 0.25)+
geom_point()+
facet_wrap(~variable, scales = "free_y", ncol = 4)+
theme_classic()+
scale_fill_manual(values = c("gray", "#8C5471"), labels = c("Healthy", "Diseeased"))+
scale_x_discrete(labels = c("Healthy", "Diseased"))+
theme(legend.title = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = "bold"),
axis.line=element_line(),
axis.title.x = element_blank(),
legend.position = c(0.87,0.25))
df %>%
filter(variable != "SD1_SD2 Ratio",
variable != "Peak (mV)",
variable != "SD2",
`Condition 4` == "1Hz") %>%
ggplot(aes(x = `Condition 2`,
y = value,
fill = `Condition 2`))+
stat_summary(fun = "mean", geom = "bar", colour = "black")+
stat_summary(fun.data = "mean_se", geom = "errorbar", width = 0.25)+
geom_point()+
facet_wrap(~variable, scales = "free_y", ncol = 4)+
theme_classic()+
scale_fill_manual(values = c("gray", "#8C5471"), labels = c("Healthy", "Diseeased"))+
scale_x_discrete(labels = c("Healthy", "Diseased"))+
theme(legend.title = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = "bold"),
axis.line=element_line(),
axis.title.x = element_blank())
outliers_plot <-
df %>%
select(-c(Operator.x, Operator.y)) %>%
gather(Operator, "Value", -c(`File Name`, Folder, Conditions, Parameter)) %>%
#filter(Parameter == "STV") %>%
ggplot(aes(x = `File Name`,
y = `Value`,
colour = `Operator`,
group = `Operator`))+
geom_point(alpha = 0.8)+
theme_clean()+
theme(#axis.text.x = element_text(angle = 90, hjust = 1),
axis.text.x=element_blank(),
legend.title = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = "bold"),
axis.line=element_line(),
axis.title.x = element_blank(),
plot.background = element_rect(color = "white"),
legend.position = c(0.87,0.25))+
scale_colour_manual(values = c("#8C5471", "black"))+
facet_wrap(~`Parameter`, ncol = 1, scales = "free")+
xlab("File")+
ggtitle("Manual vs Automated Parameter Analysis")
outliers_plot
outliers_plot <-
df %>%
select(-c(Operator.x, Operator.y)) %>%
gather(Operator, "Value", -c(`File Name`, Folder, Conditions, Parameter)) %>%
#filter(Parameter == "STV") %>%
ggplot(aes(x = `File Name`,
y = `Value`,
colour = `Operator`,
group = `Operator`))+
geom_point(alpha = 0.8)+
theme_clean()+
theme(axis.text.x=element_blank(),
legend.title = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = "bold"),
axis.line=element_line(),
axis.title.x = element_blank(),
plot.background = element_rect(color = "white"),
legend.position = c(0.87,0.25))+
scale_colour_manual(values = c("#8C5471", "black"),
labels = c("BAPTA", "Manual"))+
facet_wrap(~`Parameter`, ncol = 1, scales = "free")+
xlab("File")+
ggtitle("Manual vs Automated Parameter Analysis")
outliers_plot
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
rat_freq_means_plot <-
df %>%
filter(variable != "SD1_SD2 Ratio",
variable != "Peak (mV)",
variable != "SD2",
`Condition 4` == "1Hz") %>%
ggplot(aes(x = `Condition 2`,
y = value,
fill = `Condition 2`))+
stat_summary(fun = "mean", geom = "bar", colour = "black")+
stat_summary(fun.data = "mean_se", geom = "errorbar", width = 0.25)+
geom_point()+
facet_wrap(~variable, scales = "free_y", ncol = 4)+
theme_classic()+
scale_fill_manual(values = c("gray", "#8C5471"), labels = c("Healthy", "Diseeased"))+
scale_x_discrete(labels = c("Healthy", "Diseased"))+
theme(legend.title = element_blank(),
legend.box = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = "bold"),
axis.line=element_line(),
axis.title.x = element_blank())
rat_freq_means_plot
outliers_plot <-
df %>%
select(-c(Operator.x, Operator.y)) %>%
gather(Operator, "Value", -c(`File Name`, Folder, Conditions, Parameter)) %>%
#filter(Parameter == "STV") %>%
ggplot(aes(x = `File Name`,
y = `Value`,
colour = `Operator`,
group = `Operator`))+
geom_point(alpha = 0.8)+
theme_clean()+
theme(axis.text.x=element_blank(),
legend.title = element_blank(),
legend.box = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = "bold"),
axis.line=element_line(),
axis.title.x = element_blank(),
plot.background = element_rect(color = "white"),
legend.position = c(0.87,0.25))+
scale_colour_manual(values = c("#8C5471", "black"),
labels = c("BAPTA", "Manual"))+
facet_wrap(~`Parameter`, ncol = 1, scales = "free")+
xlab("File")+
ggtitle("Manual vs Automated Parameter Analysis")
outliers_plot
outliers_plot <-
df %>%
select(-c(Operator.x, Operator.y)) %>%
gather(Operator, "Value", -c(`File Name`, Folder, Conditions, Parameter)) %>%
#filter(Parameter == "STV") %>%
ggplot(aes(x = `File Name`,
y = `Value`,
colour = `Operator`,
group = `Operator`))+
geom_point(alpha = 0.8)+
theme_clean()+
theme(axis.text.x=element_blank(),
legend.title = element_blank(),
legend.background = element_rect(fill = "white", color = "white"),
strip.background = element_blank(),
strip.text = element_text(face = "bold"),
axis.line=element_line(),
axis.title.x = element_blank(),
plot.background = element_rect(color = "white"),
legend.position = c(0.87,0.25))+
scale_colour_manual(values = c("#8C5471", "black"),
labels = c("BAPTA", "Manual"))+
facet_wrap(~`Parameter`, ncol = 1, scales = "free")+
xlab("File")+
ggtitle("Manual vs Automated Parameter Analysis")
outliers_plot
outliers_plot <-
df %>%
select(-c(Operator.x, Operator.y)) %>%
gather(Operator, "Value", -c(`File Name`, Folder, Conditions, Parameter)) %>%
#filter(Parameter == "STV") %>%
ggplot(aes(x = `File Name`,
y = `Value`,
colour = `Operator`,
group = `Operator`))+
geom_point(alpha = 0.8)+
theme_clean()+
theme(axis.text.x=element_blank(),
legend.title = element_blank(),
legend.background = element_rect(fill = "white", color = "white"),
strip.background = element_blank(),
strip.text = element_text(face = "bold"),
axis.line=element_line(),
axis.title.x = element_blank(),
plot.background = element_rect(color = "white"),
legend.position = c(0.95,0.15))+
scale_colour_manual(values = c("#8C5471", "black"),
labels = c("BAPTA", "Manual"))+
facet_wrap(~`Parameter`, ncol = 1, scales = "free")+
xlab("File")+
ggtitle("Manual vs Automated Parameter Analysis")
#outliers_plot <-
df %>%
select(-c(Operator.x, Operator.y)) %>%
gather(Operator, "Value", -c(`File Name`, Folder, Conditions, Parameter)) %>%
#filter(Parameter == "STV") %>%
ggplot(aes(x = `File Name`,
y = `Value`,
colour = `Operator`,
group = `Operator`))+
geom_point(alpha = 0.8)+
theme_clean()+
theme(axis.text.x=element_blank(),
legend.title = element_blank(),
legend.background = element_rect(fill = "white", color = "white"),
strip.background = element_blank(),
strip.text = element_text(face = "bold"),
axis.line=element_line(),
axis.title.x = element_blank(),
plot.background = element_rect(color = "white"),
legend.position = c(0.95,0.15))+
scale_colour_manual(values = c("#8C5471", "black"),
labels = c("BAPTA", "Manual"))+
facet_wrap(~`Parameter`, ncol = 1, scales = "free")+
xlab("File")+
ggtitle("Manual vs Automated Parameter Analysis")
debugSource("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
debugSource("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
debugSource("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
debugSource("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
source("../../../libraries/libraries.R")
debugSource("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
rat_healthy_abf <- readABF::readABF("../../raw_data/rat/RN_CTR_DMSO_1Hz/18711000.abf")
rat_diseased_abf <- readABF::readABF("../../raw_data/rat/RN_STZ_DMSO_1Hz/18703019.abf")
# Transforming the traces and adding the x axis ########
rat_healthy <- data.frame(seq.int(0,
((nrow(rat_healthy_abf$data[[1]])-1)*rat_healthy_abf$samplingIntervalInSec),
rat_healthy_abf$samplingIntervalInSec),
rat_healthy_abf$data[[4]])
rat_diseased <- data.frame(seq.int(0,
((nrow(rat_diseased_abf$data[[1]])-1)*rat_diseased_abf$samplingIntervalInSec),
rat_diseased_abf$samplingIntervalInSec),
rat_diseased_abf$data[[3]])
# Plots ########
## Common plot features  ########
q <-
theme(plot.background = element_rect(color = "white"),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
plot.title = element_text(size = 16),
legend.position = c(0.85, 0.90),
legend.background = element_rect(colour="white",
size=0.5, linetype="solid"),
legend.title = element_blank())
## hiPSC-CMs Ventricular ########
rat_ventricular_plot <-
ggplot() +
geom_line(data = rat_healthy,
aes(x = rat_healthy[,1], # subtracted time to synchronize the peaks
y = rat_healthy[,2],
colour = "Immature"))+
geom_line(data = rat_diseased,
aes(x = rat_diseased[,1], # subtracted time to synchronize the peaks
y = rat_diseased[,2],
colour = "Mature"))+
coord_cartesian(x = c(0,0.4),
y = c(-80, 60))+
labs(x = "Time (s)",
y = "Voltage (mV)")+
theme_clean()+
scale_colour_manual(values = c("black", "#8C5471"), labels = c("Healthy", "Diseased"))+
q
# Averages ####
df <- read_csv("../../outputs/rat/analyses/Combined Mean Values.csv")
## REMOVING OUTLIERS
# df <-
#   df %>%
#   filter(`File Name` != "")
rat_freq_means_plot <-
df %>%
filter(variable != "SD1_SD2 Ratio",
variable != "Peak (mV)",
variable != "SD2",
`Condition 4` == "1Hz") %>%
ggplot(aes(x = `Condition 2`,
y = value,
fill = `Condition 2`))+
stat_summary(fun = "mean", geom = "bar", colour = "black")+
stat_summary(fun.data = "mean_se", geom = "errorbar", width = 0.25)+
geom_point()+
facet_wrap(~variable, scales = "free_y", ncol = 4)+
theme_classic()+
scale_fill_manual(values = c("gray", "#8C5471"), labels = c("Healthy", "Diseeased"))+
scale_x_discrete(labels = c("Healthy", "Diseased"))+
theme(legend.title = element_blank(),
strip.background = element_blank(),
strip.text = element_text(face = "bold"),
axis.line=element_line(),
axis.title.x = element_blank())
# Combine Panels ####
combined_freq_means_plot <-
plot_grid(rat_ventricular_plot,
rat_freq_means_plot,
nrow = 1,
rel_widths = c(0.8, 1.5),
labels = c("C", "D"))
# Combining with mean parameters
source("Figure 4 - Parameter_Comparison.R")
debugSource("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
plot_grid(rat_ventricular_plot,
rat_freq_means_plot,
nrow = 1,
rel_widths = c(0.8, 1.5),
labels = c("C", "D"))
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
source("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
debugSource("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
debugSource("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
debugSource("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
this.dir <- dirname(parent.frame(2)$ofile)
this.dir <- dirname(parent.frame(2)$ofile)
this.dir <- dirname(parent.frame(2)$ofile)
this.dir <- dirname(parent.frame(2)$ofile)
this.dir <- dirname(parent.frame(2)$ofile)
debugSource("~/Documents/GitHub/BAPTA/manuscript/code/Figure 4/Figure 4 - Rat Disease.R", echo=TRUE)
setwd(this.dir)
dirname(
dirname(parent.frame(2)$ofile)
dirname(parent.frame(2)$ofile)
dirname(parent.frame(2)$ofile)
dirname(parent.frame(2)$ofile)
dirname(parent.frame(2)$ofile)
dirname(parent.frame(2)$ofile)
?dirname()
parent.frame(2)
parent.frame(2)$ofile
this.dir <- dirname(parent.frame(2)$ofile)
