source("../libraries/libraries.R")
files <- list.files(path = "../data", pattern = ".csv")
for (f in 1:length(list.files)){
df_temp <- read.csv(files[f])
df <- rbind(df, df_temp)
}
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
source("../libraries/libraries.R")
files <- list.files(path = "../data", pattern = ".csv")
for (f in 1:length(files)){
df_temp <- read.csv(files[f])
df <- rbind(df, df_temp)
}
files
length(files)
files[f]
files <- list.files(path = "../data", pattern = ".csv", full.path = T)
files <- list.files(path = "../data", pattern = ".csv", full.names = T)
for (f in 1:length(files)){
df_temp <- read.csv(files[f])
df <- rbind(df, df_temp)
}
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
source("../libraries/libraries.R")
files <- list.files(path = "../data", pattern = ".csv", full.names = T)
for (f in 1:length(files)){
df_temp <- read.csv(files[f])
df <- rbind(df, df_temp)
}
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()
head(df))
head(df)
df %>%
filter(Dose.Label == "Control")
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
source("../libraries/libraries.R")
files <- list.files(path = "../data", pattern = ".csv", full.names = T)
for (f in 1:length(files)){
df_temp <- read.csv(files[f])
df <- rbind(df, df_temp)
}
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()
View(df)
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = na.omit(Mean.RR.Interval..µs.)/10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()
df %>%
filter(Dose.Label == "Control") %>%
na.omit() %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()
files
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
source("../libraries/libraries.R")
files <- list.files(path = "../data", pattern = ".csv", full.names = T)
for (f in 1:length(files)){
df_temp <- read.csv(files[f])
df <- rbind(df, df_temp)
}
files
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()
View(df)
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
source("../libraries/libraries.R")
files <- list.files(path = "../data", pattern = ".csv", full.names = T)
for (f in 1:length(files)){
df_temp <- read.csv(files[f])
df <- rbind(df,
df_temp,
setNames(rev(df),
names(df))))
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
source("../libraries/libraries.R")
files <- list.files(path = "../data", pattern = ".csv", full.names = T)
for (f in 1:length(files)){
df_temp <- read.csv(files[f])
df <- rbind(df,
df_temp,
setNames(rev(df),
names(df)))
}
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()
df <- rbind(df,
unname(df_temp))
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
source("../libraries/libraries.R")
files <- list.files(path = "../data", pattern = ".csv", full.names = T)
for (f in 1:length(files)){
df_temp <- read.csv(files[f])
df <- rbind(df,
unname(df_temp))
}
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
source("../libraries/libraries.R")
files <- list.files(path = "../data", pattern = ".csv", full.names = T)
for (f in 1:length(files)){
df_temp <- read.csv(files[f])
df <- rbind(df,
df_temp)
}
View(df)
files
length(files)
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
source("../libraries/libraries.R")
files <- list.files(path = "../data", pattern = ".csv", full.names = T)
for (f in 1:length(files)){
df_temp <- read.csv(files[f])
df <- rbind(df,
df_temp)
}
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
source("../libraries/libraries.R")
files <- list.files(path = "../data", pattern = ".csv", full.names = T)
df <- data.frame()
df_temp <- data.frame()
for (f in 1:length(files)){
df_temp <- read.csv(files[f])
df <- rbind(df,
df_temp)
}
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()+
labs(x = "RR (ms)",
y = "FPD (ms)")
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()+
labs(x = "RR (ms)",
y = "FPD (ms)")+
geom_smooth(metho = "lm")
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()+
labs(x = "RR (ms)",
y = "FPD (ms)")+
geom_smooth(method = "lm")
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()+
labs(x = "RR (ms)",
y = "FPD (ms)")+
geom_smooth(method = "lm")
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
source("../libraries/libraries.R")
files <- list.files(path = "../data", pattern = ".csv", full.names = T)
df <- data.frame()
df_temp <- data.frame()
for (f in 1:length(files)){
df_temp <- read.csv(files[f])
df <- rbind(df,
df_temp)
}
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()+
labs(x = "RR (ms)",
y = "FPD (ms)")+
geom_smooth(method = "lm")
files <- list.files(path = "../data", pattern = ".csv", full.names = T)
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
source("../libraries/libraries.R")
files <- list.files(path = "../data", pattern = ".csv", full.names = T)
df <- data.frame()
df_temp <- data.frame()
for (f in 1:length(files)){
df_temp <- read.csv(files[f])
df <- rbind(df,
df_temp)
}
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()+
labs(x = "RR (ms)",
y = "FPD (ms)")+
geom_smooth(method = "lm")
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()+
labs(x = "RR (ms)",
y = "FPD (ms)")+
geom_smooth(method = "lm")
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
source("../libraries/libraries.R")
files <- list.files(path = "../data", pattern = ".csv", full.names = T)
df <- data.frame()
df_temp <- data.frame()
for (f in 1:length(files)){
df_temp <- read.csv(files[f])
df <- rbind(df,
df_temp)
}
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
source("../libraries/libraries.R")
files <- list.files(path = "../data", pattern = ".csv", full.names = T)
df <- data.frame()
df_temp <- data.frame()
for (f in 1:length(files)){
df_temp <- read.csv(files[f])
df <- rbind(df,
df_temp)
}
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()+
labs(x = "RR (ms)",
y = "FPD (ms)")+
geom_smooth(method = "lm")
print(paste("The number of files analysed is", length(files)))
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()+
labs(x = "RR (ms)",
y = "FPD (ms)",
title = "ad")+
geom_smooth(method = "lm")
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Mean.RR.Interval..µs./10^3,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
geom_point()+
labs(title= "FPD/RR",
x = "RR (ms)",
y = "FPD (ms)")+
geom_smooth(method = "lm")
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = `Cell Line`,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
stat_summary(fun = "mean", geom = "bar")+
stat_summary(fun.data = "mean_se", geom = "errorbar", width = 0.25)
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Cell.Line,
y = T.Detection.Timestamp..µs./10^3,
colour = Cell.Line))+
stat_summary(fun = "mean", geom = "bar")+
stat_summary(fun.data = "mean_se", geom = "errorbar", width = 0.25)
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Cell.Line,
y = T.Detection.Timestamp..µs./10^3,
fill = Cell.Line))+
stat_summary(fun = "mean", geom = "bar")+
stat_summary(fun.data = "mean_se", geom = "errorbar", width = 0.25)
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Cell.Line,
y = T.Detection.Timestamp..µs./10^3,
fill = Cell.Line))+
stat_summary(fun = "mean", geom = "bar", colour = "black")+
stat_summary(fun.data = "mean_se", geom = "errorbar", width = 0.25)
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Cell.Line,
y = T.Detection.Timestamp..µs./10^3,
fill = Cell.Line))+
stat_summary(fun = "mean", geom = "bar", colour = "black")+
stat_summary(fun.data = "mean_se", geom = "errorbar", width = 0.25)+
labs(title= "FPD",
x = "Cell Line",
y = "FPD (ms)")+
geom_smooth(method = "lm")
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Cell.Line,
y = T.Detection.Timestamp..µs./10^3,
fill = Cell.Line))+
stat_summary(fun = "mean", geom = "bar", colour = "black")+
stat_summary(fun.data = "mean_se", geom = "errorbar", width = 0.25)+
labs(title= "FPD",
x = "Cell Line",
y = "FPD (ms)")
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Cell.Line,
y = T.Detection.Timestamp..µs./10^3,
fill = Cell.Line))+
stat_summary(fun = "mean", geom = "violin", colour = "black")+
stat_summary(fun.data = "mean_se", geom = "errorbar", width = 0.25)+
labs(title= "FPD",
x = "Cell Line",
y = "FPD (ms)")
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Cell.Line,
y = T.Detection.Timestamp..µs./10^3,
fill = Cell.Line))+
geom_boxplot()+
labs(title= "FPD",
x = "Cell Line",
y = "FPD (ms)")
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Cell.Line,
y = T.Detection.Timestamp..µs./10^3,
fill = Cell.Line))+
geom_boxplot()+
labs(title= "FPD",
x = "Cell Line",
y = "FPD (ms)")
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Cell.Line,
y = T.Detection.Timestamp..µs./10^3,
fill = Cell.Line))+
geom_boxplot(width = 0.5)+
labs(title= "FPD",
x = "Cell Line",
y = "FPD (ms)")
df %>%
filter(Dose.Label == "Control") %>%
ggplot(aes(x = Cell.Line,
y = T.Detection.Timestamp..µs./10^3,
fill = Cell.Line))+
geom_boxplot()+
labs(title= "FPD",
x = "Cell Line",
y = "FPD (ms)")
source("~/My Drive/Progetti/2019_Leducq/Collaborations/LQT1 Pathogenicity Brett Kroncke Project/20220406_merge_db_LQT1_con_dbBrett_dati_clinici_Carla/20220415_Analisi_dbLQT1.R", echo=TRUE)
df %>%
filter(Disease == "LQT1-RW") %>%
filter(`Amino Acid Change` == "R190W" | `Amino Acid Change` == "R594Q") %>%
group_by(`Amino Acid Change`) %>%
select(`Cardiac Events`) %>%
tally()
df %>%
filter(`Cardiac Events` != "NA") %>%
filter(`Cardiac Events` == "Yes" |
`Cardiac Events` == "No") %>%
filter(Disease == "LQT1-RW") %>%
group_by(`Amino Acid Change`) %>%
mutate(meanQTc = mean(as.double((`Basal QTc (ms)`)), na.rm = T)) %>%
ggplot(aes(x = reorder(`Amino Acid Change`, `Cardiac Events` == "Yes"),
fill = `Cardiac Events`))+
geom_bar(position = "fill")+
labs(x = "Variant", y = "Relative Ratio")+
scale_fill_manual(values=c("#999999", "#ff6961"))+
scale_y_continuous(labels=scales::percent)+
theme_base(base_size = 10)+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14),
strip.text = element_text(size = 16, face = "bold"),
plot.background = element_rect(color = "white"),
legend.position="bottom")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
df %>%
filter(`Cardiac Events` != "NA") %>%
filter(Disease == "LQT1-RW") %>%
group_by(`Amino Acid Change`) %>%
mutate(meanQTc = mean(as.double((`Basal QTc (ms)`)), na.rm = T)) %>%
filter(`Amino Acid Change` == "R190Q" |
`Amino Acid Change` == "R190W" |
`Amino Acid Change` == "R594Q" |
`Amino Acid Change` == "A344V" |
`Amino Acid Change` == "A344A" |
`Amino Acid Change` == "Y111C" |
`Amino Acid Change` == "A341V") %>%
ggplot(aes(x = reorder(`Amino Acid Change`, `Cardiac Events` == "Yes"),
fill = `Cardiac Events`))+
geom_bar(position = "fill")+
geom_text(stat='count', aes(label=..count..), position = "fill", size = 8)+
labs(x = "Variant", y = "Relative Ratio")+
scale_fill_manual(values=c("#999999", "#ff6961"))+
scale_y_continuous(labels=scales::percent)+
theme_base(base_size = 10)+
theme(axis.text=element_text(size=14),
axis.title=element_text(size=16),
strip.text = element_text(size = 18, face = "bold"),
title = element_text(size = 18, face = "bold"),
legend.text = element_text(size = 14),
legend.position="bottom",
plot.background = element_rect(color = "white"))
filter(Disease == "LQT1-RW") %>%
group_by(`Amino Acid Change`) %>%
mutate(meanQTc = mean(as.double((`Basal QTc (ms)`)), na.rm = T)) %>%
filter(`Amino Acid Change` == "R190Q" |
`Amino Acid Change` == "R190W" |
`Amino Acid Change` == "R594Q" |
`Amino Acid Change` == "A344V" |
`Amino Acid Change` == "A344A" |
`Amino Acid Change` == "Y111C" |
`Amino Acid Change` == "A341V") %>%
ggplot(aes(x = reorder(`Amino Acid Change`, meanQTc),
y = as.double((`Basal QTc (ms)`))))+
geom_violin()+
stat_summary(fun = "mean", geom = "point", size = 4)+
stat_summary(fun.data = "mean_se", geom = "errorbar", width = 0.1)+
geom_jitter(width = 0.15, alpha = 0.25)+
#geom_jitter(data = hl, aes(x = `Amino Acid Change`, y = as.integer(`Basal QTc (ms)`), colour = "red"))+
ylim(350,700)+
labs(x = "Variant", y = "Basal QTc (ms)")+
annotate("rect", xmin = 0, xmax = Inf, ymin = 350, ymax = 440,
alpha = .4, fill = "#50C878")+
#theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
theme_base(base_size = 10)+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14),
strip.text = element_text(size = 16, face = "bold"),
plot.background = element_rect(color = "white"))
df %>%
filter(Disease == "LQT1-RW") %>%
group_by(`Amino Acid Change`) %>%
mutate(meanQTc = mean(as.double((`Basal QTc (ms)`)), na.rm = T)) %>%
filter(`Amino Acid Change` == "R190Q" |
`Amino Acid Change` == "R190W" |
`Amino Acid Change` == "R594Q" |
`Amino Acid Change` == "A344V" |
`Amino Acid Change` == "A344A" |
`Amino Acid Change` == "Y111C" |
`Amino Acid Change` == "A341V") %>%
ggplot(aes(x = reorder(`Amino Acid Change`, meanQTc),
y = as.double((`Basal QTc (ms)`))))+
geom_violin()+
stat_summary(fun = "mean", geom = "point", size = 4)+
stat_summary(fun.data = "mean_se", geom = "errorbar", width = 0.1)+
geom_jitter(width = 0.15, alpha = 0.25)+
#geom_jitter(data = hl, aes(x = `Amino Acid Change`, y = as.integer(`Basal QTc (ms)`), colour = "red"))+
ylim(350,700)+
labs(x = "Variant", y = "Basal QTc (ms)")+
annotate("rect", xmin = 0, xmax = Inf, ymin = 350, ymax = 440,
alpha = .4, fill = "#50C878")+
#theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
theme_base(base_size = 10)+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14),
strip.text = element_text(size = 16, face = "bold"),
plot.background = element_rect(color = "white"))
reticulate::repl_python()
reticulate::repl_python()
debugSource("~/Documents/GitHub/AP-batch-analysis/scripts/AP_Gap_Free_Analysis.R", echo=TRUE)
